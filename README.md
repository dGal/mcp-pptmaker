# mcp-pptmaker

Minimal MCP stdio server that converts Marp Markdown into a PPTX and returns it as base64. The server exposes a single tool via MCP and is implemented in [src/index.js](src/index.js).

Key points
- One tool: generate a PowerPoint from Marp-flavored Markdown.
- The theme and options are controlled via Marp front-matter inside your Markdown.
- No local file access is enabled (do not rely on local image/assets).
- Output is a JSON string with filename, MIME type, and base64 file data.

Requirements
- Node.js 18+
- Dependencies are declared in [package.json](package.json)

Install
- In this workspace, install dependencies:
  - npm install

MCP configuration

Add an entry to your MCP settings (Roo Code MCP settings path: /home/galda/.config/Code/User/globalStorage/rooveterinaryinc.roo-cline/settings/mcp_settings.json). Adjust the absolute path to this repository.

Example:
{
  "mcpServers": {
    "mcp-pptmaker": {
      "command": "node",
      "args": [
        "/absolute/path/to/this/repo/src/index.js"
      ],
      "disabled": false,
      "alwaysAllow": [],
      "disabledTools": [],
      "timeout": 120
    }
  }
}

Claude Desktop (optional, adjust path accordingly)
- Edit your Claude desktop config (e.g., ~/.config/Claude/claude_desktop_config.json on Linux). The format is the same:
{
  "mcpServers": {
    "mcp-pptmaker": {
      "command": "node",
      "args": [
        "/absolute/path/to/this/repo/src/index.js"
      ],
      "disabled": false,
      "alwaysAllow": [],
      "disabledTools": [],
      "timeout": 120
    }
  }
}

Tool: generate_pptx
- Input parameters (single):
  - markdown: string (Marp Markdown with optional front-matter controlling theme)
- Output:
  - JSON string with:
    {
      "filename": "presentation.pptx",
      "mimeType": "application/vnd.openxmlformats-officedocument.presentationml.presentation",
      "base64": "..."
    }

Usage example (Markdown)
- See [samples/example.md](samples/example.md) for a ready-to-use deck.
- Paste the content of samples/example.md into the tool parameter "markdown".

Example Marp deck
---
marp: true
theme: default
paginate: true
---
# mcp-pptmaker

This deck was generated by an MCP server.

---
## Agenda

- Why Marp
- How to use the tool
- Result

---
## Code

```js
console.log('Hello from Marp!');
```

Security and behavior
- Local files are disallowed by default (we do not pass allow-local-files).
- The server writes to an isolated temporary directory and does not load ambient Marp configs.
- If local images or external assets are referenced, they may not resolve.

Implementation notes
- The server is implemented in [src/index.js](src/index.js).
- It invokes Marp to produce a PPTX and returns the result as base64 in a JSON string.
- The binary and dependencies are provided via @marp-team/marp-cli from [package.json](package.json).

Run via npx (future)
- Once published to npm as a package with a bin, it can be run via:
  - npx mcp-pptmaker
- For now, run it through MCP using "node /absolute/path/to/this/repo/src/index.js".

Ignore rules
- See [.gitignore](.gitignore) for typical Node.js ignores.

License
- MIT (or set your preferred license)